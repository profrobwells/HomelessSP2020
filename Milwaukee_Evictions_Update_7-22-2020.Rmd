---
title: "Milwaukee County and City Evictions Analysis"
author: "Rob Wells"
date: "8/5/2020"
output: html_document
---

# Analyzing Eviction Court Data From Milwaukee
### Data analysis by Rob Wells


- **The records were scraped from this website**  
https://wcca.wicourts.gov/advanced.html 

https://github.com/Howard-Center-Investigations/evictions/blob/master/cleaning/output/all_standardized/sta_wi_milwaukee_2019_2020.csv

--------------------------------------------------------------------
- **Part 1: Load Libraries and Data**

```{r include=FALSE}
library(tidyverse)
library(janitor)
library(lubridate)
library(kableExtra)
```
Load Milwaukee City and County Data for Evictions tab
```{r}
milw <- rio::import("https://raw.githubusercontent.com/Howard-Center-Investigations/evictions/master/cleaning/output/cities_original/wi_milwaukee_2019_2020.csv?token=AK7LSTECLG4CSE7CSOGT7AS7FRWA2") 
```


- **Clean names**
```{r}
milw <- janitor::clean_names(milw)
```

- **Parse Cities **
```{r}
milw$defendant_address <- milw$defendant_one_address

x <- separate(data = milw, col = defendant_address, into = c("address", "city", "state_zip"), sep = ", ", extra = "merge", fill = "right")
```

```{r}
x %>% 
  group_by(city) %>%
  count(city) %>% 
  arrange(desc(n))
```

- **Check data fields**
```{r}
glimpse(milw)
```
- **Process dates** 
```{r}
#Process dates
milw$date <- ymd(milw$file_date)
```

```{r}
milw <- milw %>% 
  mutate(yearmon = format(date, "%Y-%m"))
```
- **Check data fields**
```{r}
glimpse(milw)
```
### Total Eviction Filings by Month in Milwaukee City and County, Jan. 1 2019-July 31, 2020
**Wisconsin eviction moratorium was March 27 - May 27, 2020**
```{r}
z <- milw %>% 
  group_by(yearmon) %>%
  count(yearmon)
z
#write.csv(z, "miltotal.8.4.2020.csv")

```

-- **Context: Total eviction filings in Wisconsin City and County since Jan. 1, 2019: 19,423**
```{r}
summary(z$n)
sum(z$n)
```

- **Chart of Milwaukee City and County Eviction Filings, Jan 1. 2019-July 31, 2020**  
**Wisconsin eviction moratorium was March 27 - May 27, 2020**
```{r}

ggplot(z, aes(x=yearmon, y=n, fill=yearmon)) +
  geom_col() +
   theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  labs(title="Milwaukee City-County Eviction Filings Per Month Jan. 2019-July 2020",y="Evictions", x= "", 
       caption = "Graphic by Rob Wells. 8-4-2020", subtitle = "Source: Wisconsin Circuit Court records")+
  theme(legend.position="none") 
ggsave("Milw_Evict_8_5_2020.png",device = "png",width=9,height=6, dpi=500)
```

-- **Clean the columns - remove stray spaces**

```{r}
p <- milw
```

```{r}
p$plaintiff_one <- str_trim(p$plaintiff_one)
p$defendant_one <- str_trim(p$defendant_one)
p$plaintiff_one <- gsub("[[:punct:]]", "", p$plaintiff_one)
p$plaintiff_one <- gsub("[[:punct:]]", "", p$plaintiff_one)
p$defendant_one <- gsub("[[:punct:]]", "", p$defendant_one)
head(p)
```

-- **Summary of Milwaukee Plaintiffs **
```{r}
#Build a simple summary table
plaintiff1 <- p %>% 
  select(plaintiff_one, defendant_one, date) %>% 
         group_by(plaintiff_one) %>% 
         count(plaintiff_one) %>% 
         ungroup() %>% 
         arrange(desc(n))

#write.csv(plaintiff1, "milplaintiff.7.6.2020.csv")


plaintiff1
```
```{r}
#quick fact check on totals: 19,423 checks out
sum(plaintiff1$n)
```

--**Context**: During the entire course of this study, the 19,423 eviction records since January 2019, the average number of evictions by a landlord was 3. 
```{r}
summary(plaintiff1)
```


-- **Milwaukee City and County all since March 27 2020: 2,929 Eviction Filings**
```{r}
x <- p %>% 
  filter(date > '2020-03-27')

write.csv(x, "mil_all_march27forward.csv")

```

-- **Milwaukee City - County evictions / Plaintiffs since March 27 2020**
```{r}
moratorium <- p %>% 
  filter(date > '2020-03-27') %>% 
  select(plaintiff_one, defendant_one, date) %>% 
         group_by(plaintiff_one) %>% 
         count(plaintiff_one) %>% 
         ungroup() %>% 
         arrange(desc(n))

#write.csv(moratorium, "milplaintiff.8.4.2020.csv")

```

--**Context: Total Evictions in Milwaukee City - County since March 27, 2020: 2,929**
```{r}
sum(moratorium$n)
```

-- **Milwaukee City - County Plaintiffs since March 27 2020**
```{r}
top <- p %>% 
  filter(date > '2020-03-27') %>% 
  select(plaintiff_one, yearmon) %>% 
         group_by(plaintiff_one, yearmon) %>% 
         count(plaintiff_one) %>% 
         filter(n > 5) %>% 
         ungroup() %>% 
         arrange(yearmon) %>% 
         arrange(desc(n))
write.csv(top, "mil_evictors_mo_8_4_2020.csv")
head(top)
```

--**Context**: Since the moratorium, the 2,929 eviction records since March 27, 2020, the average number of evictions by a landlord was 2. 

```{r}
summary(moratorium)
```

##Cleaning of Plaintiffs Names, Normalizing and Grouping

```{r}
p2 <- p
```

```{r}
p2$plaintiff_fixed <- p2$plaintiff_one
```


```{r}
glimpse(p2)
```

--**Rename and Reclassify Landlords, Substitute top names and normalize**
```{r}
p2 <- p2 %>% 
  mutate(plaintiff_fixed = case_when(plaintiff_one=="meaux park llc" ~ "berrada",
                                     plaintiff_one=="spring court apartments llc" ~ "berrada",
                                     plaintiff_one=="dineen park townhomes llc" ~ "berrada",
                                     plaintiff_one=="arbor gardens apartments llc" ~ "berrada",
                                     plaintiff_one=="luther haven llc" ~ "berrada",
                                     plaintiff_one=="willow court apartments llc" ~ "berrada",
                                     plaintiff_one=="garden terrace homes llc" ~ "berrada",
                                     plaintiff_one=="good hope townhomes ii llc" ~ "berrada",
                                     plaintiff_one=="good hope townhomes llc" ~ "berrada",
                                     plaintiff_one=="colonial pointe ii apartments llc" ~ "berrada",
                                     plaintiff_one=="colonial pointe il apartments llc" ~ "berrada",
                                     plaintiff_one=="colonial pointe i apartments llc" ~ "berrada",
                                     plaintiff_one=="mariners pointe apartments llc" ~ "berrada",
                                     plaintiff_one=="berrada properties llc" ~ "berrada",
                                     plaintiff_one=="yb florist llc" ~ "berrada",
                                     plaintiff_one=="yb medford llc" ~ "berrada",
                                     plaintiff_one=="yb silver spring llc" ~ "berrada",
                                     plaintiff_one=="yb victory llc" ~ "berrada",
                                     plaintiff_one=="falcon crest llc" ~ "berrada",
                                     plaintiff_one=="wisniewski michael s" ~ "michael_s_wisniewski",
                                     plaintiff_one=="bruckner daniel w" ~ "daniel_w_bruckner",
                                     plaintiff_one=="nawrocki gregory w" ~ "gregory_w_nawrocki",
                                     plaintiff_one=="nawrocki gregory" ~ "gregory_w_nawrocki",
                                     plaintiff_one=="nawrocki gragory w" ~ "gregory_w_nawrocki",
                                     plaintiff_one=="martin bruce" ~ "bruce_martin",
                                     plaintiff_one=="housing authority of the city of milwaukee" ~ "milwaukee_city_housing_authority",
                                     plaintiff_one=="city of milwaukee" ~ "milwaukee_city",
                                     plaintiff_one=="city  of milwaukee" ~ "milwaukee_city",
                                     plaintiff_one=="milwaukee living llc" ~ "milwaukee_living",
                                     plaintiff_one=="milwaukee capital properties llc" ~ "milwaukee_capital_properties",
                                     plaintiff_one=="good hope townhomes ii llc" ~ "good_hope_townhomes",
                                     plaintiff_one=="good hope townhomes llc" ~ "good_hope_townhomes",
                                     plaintiff_one=="howard and th street holding company" ~ "howard_76_st_holding_co",
                                     plaintiff_one=="maas robert" ~ "robert_maas",
                                     plaintiff_one=="maas robert j" ~ "robert_maas",
                                    TRUE~plaintiff_one)) 

```


--**Simple table for fact checking on normalization of names**
```{r}
pp2 <- p2 %>% 
  select(plaintiff_one, plaintiff_fixed)
```


--**Context**: Berrada properties and its 18 affiliates were responsible for 2,223 eviction filings in Milwaukee City and County, or at least 11% of all eviction filings since January 2019.


```{r}
#Summary of Cleaned Milwaukee Plaintiffs
plaintiff2 <- p2 %>% 
  select(plaintiff_fixed, date) %>% 
         group_by(plaintiff_fixed) %>% 
         count(plaintiff_fixed) %>% 
         ungroup() %>% 
         arrange(desc(n))

write.csv(plaintiff2, "milplaintiff.cleaned.8.4.2020.csv")


plaintiff2
```

--**Context: Berrada was responsible for 17% of eviction filings in Milwaukee City and County since March 27, 2020.** Since the moratorium started in March 27, 2020, there have been 2,929 evictions. Berrada and its 18 affiliated entities had 487 evictions, or 17% of the total.
```{r}
#Cleaned Milwaukee Plaintiffs since March 27 2020
top2 <- p2 %>% 
  filter(date > '2020-03-27') %>% 
  select(plaintiff_fixed, yearmon) %>% 
         group_by(plaintiff_fixed) %>% 
         count(plaintiff_fixed) %>% 
         filter(n > 5) %>% 
         ungroup() %>% 
         arrange(desc(n))
write.csv(top2, "cleaned_mil_evictors_since_March27_8_5_2020.csv")
top2
```


--**Top with top 50 Results of Milwaukee Landlords**
```{r}
top2 %>% 
  top_n(50, n) %>% 
  kable() %>% 
  kable_styling("striped")

```


--**Cleaned Milwaukee Plaintiffs by Month since March 27 2020**
```{r}
top3 <- p2 %>% 
  filter(date > '2020-03-27') %>% 
  select(plaintiff_fixed, yearmon) %>% 
         group_by(plaintiff_fixed, yearmon) %>% 
         count(plaintiff_fixed) %>% 
         filter(n > 5) %>% 
         ungroup() %>% 
         arrange(yearmon) %>% 
         arrange(desc(n))
write.csv(top3, "cleaned_mil_evictors_mo_8_4_2020.csv")
head(top3)
```






--**30**
